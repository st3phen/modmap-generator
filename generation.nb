(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     84471,       1549]
NotebookOptionsPosition[     82712,       1493]
NotebookOutlinePosition[     83100,       1510]
CellTagsIndexPosition[     83057,       1507]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization + Settings", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
  3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
  3.5900258211132956`*^9}, {3.607303430323289*^9, 3.6073034315043564`*^9}, {
  3.6073055051589622`*^9, 3.6073055070440702`*^9}, {3.6256171970165305`*^9, 
  3.625617213503903*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<CGR`\>\"", "]"}], ";", " ", 
    RowBox[{"Needs", "[", "\"\<CPUDistances`\>\"", "]"}], ";", " ", 
    RowBox[{"Needs", "[", "\"\<GPUDistances`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "directories", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fastaDir", " ", "=", " ", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<fasta\>\""}], 
       "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"workDir", " ", "=", " ", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<work\>\""}], 
       "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"outputDir", " ", "=", " ", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", " ", "\"\<output\>\""}],
        "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"generation", " ", "settings"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"blockSize", " ", "=", " ", "100"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "the", " ", "number", " ", "of", " ", "CGRs", " ", "per", " ", "block"}],
      " ", "-", " ", 
     RowBox[{
      RowBox[{"note", " ", "~", "6.5"}], "MB", " ", "RAM", " ", "required", 
      " ", "per", " ", "CGR"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"CGR", " ", "settings"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"k", " ", "=", " ", "9"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cgrOrder", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<A\>\"", ",", " ", "\"\<C\>\"", ",", " ", "\"\<G\>\"", ",", " ", 
       "\"\<T\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"descriptors", " ", "settings"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bins", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "1", ",", " ", "2", ",", " ", "5", ",", " ", "20", ",", 
       " ", "Infinity"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"windowsizes", " ", "=", " ", 
     RowBox[{"{", "8", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"steps", " ", "=", " ", 
     RowBox[{"{", "8", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"parallel", " ", "launch", " ", "functions"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LaunchCPUKernels", "[", "]"}], " ", ":=", " ", 
     RowBox[{"(", "\n", "\t", 
      RowBox[{
       RowBox[{"SetDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", "\n", "\n", "\t", 
       RowBox[{"CloseKernels", "[", "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "stop", " ", "all", " ", "running", " ", "kernels", " ", "first"}], 
        "*)"}], "\n", "\t", 
       RowBox[{"LaunchKernels", "[", "$ProcessorCount", "]"}], ";", "\n", 
       "\n", "\t", 
       RowBox[{"ParallelNeeds", "[", "\"\<CGR`\>\"", "]"}], ";", " ", 
       RowBox[{"ParallelNeeds", "[", "\"\<CPUDistances`\>\"", "]"}], ";", 
       "\n", "\t", 
       RowBox[{"DistributeDefinitions", "[", 
        RowBox[{
        "fastaDir", ",", " ", "workDir", ",", " ", "k", ",", " ", "bins", ",",
          " ", "windowsizes", ",", " ", "steps", ",", " ", "cgrOrder"}], 
        "]"}], ";"}], "\n", ")"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"LaunchGPUKernels", "[", "]"}], " ", ":=", " ", 
     RowBox[{"(", "\n", "\t", 
      RowBox[{
       RowBox[{"SetDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", "\n", "\n", "\t", 
       RowBox[{"CloseKernels", "[", "]"}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "stop", " ", "all", " ", "running", " ", "kernels", " ", "first"}], 
        "*)"}], "\n", "\t", 
       RowBox[{"LaunchKernels", "[", "$CUDADeviceCount", "]"}], ";", "\n", 
       "\n", "\t", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ParallelEvaluate", "[", "\n", "\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Needs", "[", "\"\<CUDALink`\>\"", "]"}], ";", " ", "\n",
              "\t\t", 
             RowBox[{"$CUDADevice", " ", "=", " ", 
              RowBox[{"First", "@", "#2"}]}], ";", "\n", "\t\t", 
             RowBox[{"Needs", "[", "\"\<GPUDistances`\>\"", "]"}], ";"}], " ",
             "\n", "\t", ",", " ", "#1"}], "]"}], "&"}], ",", " ", 
         RowBox[{"Kernels", "[", "]"}]}], "]"}], ";", "\n", "\n", "\t", 
       RowBox[{"ParallelNeeds", "[", "\"\<CGR`\>\"", "]"}], ";", " ", 
       RowBox[{"ParallelNeeds", "[", "\"\<CPUDistances`\>\"", "]"}], ";", 
       "\n", "\t", 
       RowBox[{"DistributeDefinitions", "[", 
        RowBox[{
        "fastaDir", ",", " ", "workDir", ",", " ", "k", ",", " ", 
         "cgrOrder"}], "]"}], ";"}], "\n", ")"}]}], ";"}]}]}]], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{
  3.6256172004702168`*^9, {3.62562306001648*^9, 3.6256230609383593`*^9}, {
   3.6307852484469695`*^9, 3.63078525293657*^9}, {3.6307999491667323`*^9, 
   3.6308000550246506`*^9}, {3.630801473900242*^9, 3.6308014747752438`*^9}, {
   3.6308713626648216`*^9, 3.6308713650584764`*^9}, {3.6308790980736923`*^9, 
   3.630879118228237*^9}, {3.630879386144072*^9, 3.630879395757658*^9}, {
   3.6308794937615623`*^9, 3.6308795019878693`*^9}, {3.6308803752337914`*^9, 
   3.630880378111162*^9}, {3.6308819998942194`*^9, 3.6308820001285973`*^9}, {
   3.630891869376439*^9, 3.630891986613722*^9}, {3.630892022010062*^9, 
   3.630892024058154*^9}, {3.630892081207629*^9, 3.6308920949945784`*^9}, {
   3.630892148071447*^9, 3.630892166518757*^9}, 3.6308921985980186`*^9, {
   3.630892313119958*^9, 3.630892317716487*^9}, {3.6308923821378155`*^9, 
   3.6308923980327673`*^9}, {3.6308924353629475`*^9, 
   3.6308924786155777`*^9}, {3.630893073590269*^9, 3.630893117140277*^9}, {
   3.6309271837638483`*^9, 3.6309272284929123`*^9}, 3.630927310249522*^9, {
   3.6309338204500194`*^9, 3.6309338264233127`*^9}, {3.6309339779463367`*^9, 
   3.630933990997563*^9}, {3.630934678669303*^9, 3.630934680498234*^9}, {
   3.6309357803179917`*^9, 3.630935783294162*^9}, {3.630936336999977*^9, 
   3.6309363394231176`*^9}, {3.6312219370809946`*^9, 
   3.6312219382010546`*^9}, {3.632262479420512*^9, 3.632262517721595*^9}, 
   3.632263071869259*^9, {3.632263137170296*^9, 3.632263138405982*^9}, {
   3.6322666397197556`*^9, 3.632266692041563*^9}, {3.6322673160029554`*^9, 
   3.6322673195975227`*^9}, 3.6322673900728455`*^9, {3.6322688543708477`*^9, 
   3.63226888654901*^9}, {3.6322690792033386`*^9, 3.6322690795939636`*^9}, {
   3.632426010904023*^9, 3.6324260412095785`*^9}, {3.6327478534472027`*^9, 
   3.6327478561052303`*^9}, {3.6336381566323214`*^9, 
   3.6336381593992853`*^9}, {3.6337154102840557`*^9, 3.633715450563326*^9}, {
   3.6337162721855693`*^9, 3.633716277037178*^9}, 3.6337165239544115`*^9, {
   3.633722246237638*^9, 3.63372224767284*^9}, {3.6337435600959187`*^9, 
   3.633743617519619*^9}, {3.6338072610918117`*^9, 3.633807299579683*^9}, {
   3.633807671882152*^9, 3.6338076743469563`*^9}, {3.6338156655456276`*^9, 
   3.6338156900240707`*^9}, {3.6338186341389437`*^9, 3.633818634248144*^9}, 
   3.6338791248385887`*^9, {3.6338800627639713`*^9, 3.633880062982372*^9}, {
   3.633885940500923*^9, 3.63388600102903*^9}, {3.6340770654743624`*^9, 
   3.6340770657373776`*^9}, {3.634077144492882*^9, 3.634077144643891*^9}, {
   3.634312694273406*^9, 3.6343126946010065`*^9}, {3.639919249020955*^9, 
   3.639919297528441*^9}, {3.639920926820746*^9, 3.63992094019897*^9}, {
   3.639921209686166*^9, 3.6399212098011723`*^9}, {3.639922038189876*^9, 
   3.6399220510462985`*^9}, {3.6399220815855637`*^9, 
   3.6399221165300255`*^9}, {3.639922191466833*^9, 3.6399221960532413`*^9}, {
   3.6399222388557596`*^9, 3.639922332423728*^9}, {3.639922504462894*^9, 
   3.6399225186961193`*^9}, 3.639923958957144*^9, {3.6399240156867375`*^9, 
   3.6399241654345665`*^9}, {3.6399242480681143`*^9, 
   3.6399242694073524`*^9}, {3.641049027555664*^9, 3.641049058725586*^9}, {
   3.641049406482422*^9, 3.6410494669560547`*^9}, {3.6410495791640625`*^9, 
   3.641049613169922*^9}, {3.6410561461708984`*^9, 3.6410561663896484`*^9}, {
   3.642517933701172*^9, 3.6425179339560547`*^9}, {3.642518118463867*^9, 
   3.642518119064453*^9}, {3.64251815259375*^9, 3.6425181902958984`*^9}, {
   3.6425182513759766`*^9, 3.642518288352539*^9}, {3.6429493711953125`*^9, 
   3.6429493713623047`*^9}, {3.642949401779297*^9, 3.642949409888672*^9}, {
   3.6429543953398438`*^9, 3.6429544046523438`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute CGRs + descriptors", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
   3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
   3.5900258211132956`*^9}, {3.607303430323289*^9, 3.6073034315043564`*^9}, {
   3.6073055051589622`*^9, 3.6073055070440702`*^9}, 3.625623168402526*^9, 
   3.625623259207557*^9, {3.6338262314334517`*^9, 3.6338262418542695`*^9}, {
   3.6338316726784782`*^9, 3.6338316738016806`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"files", " ", "=", " ", 
   RowBox[{"FileNames", "[", "\"\<*.fasta\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"fileBlocks", " ", "=", " ", 
    RowBox[{"Partition", "[", 
     RowBox[{
     "files", ",", " ", "blockSize", ",", " ", "blockSize", ",", " ", "1", 
      ",", " ", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"queue", " ", "the", " ", "execution"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"LaunchCPUKernels", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jobs", " ", "=", " ", 
    RowBox[{"MapIndexed", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "\n", "\t", 
        RowBox[{
         RowBox[{"files", " ", "=", " ", "#1"}], ";", "\n", "\t", 
         RowBox[{"blockNum", " ", "=", " ", 
          RowBox[{"First", "@", "#2"}]}], ";", "\n", "\n", "\t", 
         RowBox[{"ParallelSubmit", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"files", ",", " ", "blockNum"}], "}"}], ",", " ", "\n", 
           "\t\t", 
           RowBox[{
            RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";", "\n", "\n", 
            "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"compute", " ", "CGRs"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"cgrBlock", " ", "=", " ", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", "\n", "\t\t\t", 
                 RowBox[{
                  RowBox[{"seq", " ", "=", " ", 
                   RowBox[{"First", "@", 
                    RowBox[{"Import", "[", "#", "]"}]}]}], ";", "\t\t\t\t", 
                  "\n", "\t\t\t", 
                  RowBox[{"N", "@", 
                   RowBox[{"FCGR", "[", 
                    RowBox[{"seq", ",", " ", "cgrOrder", ",", " ", "k"}], 
                    "]"}]}]}], "\n", "\t\t", ")"}], "&"}], ",", " ", 
               "files"}], "]"}]}], ";", "\n", "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"save", " ", "CGRs"}], " ", "*)"}], "\n", "\t\t", 
            RowBox[{"SetDirectory", "[", "workDir", "]"}], ";", "\n", "\t\t", 
            RowBox[{"DumpSave", "[", 
             RowBox[{
              RowBox[{"\"\<cgrs_\>\"", " ", "<>", " ", 
               RowBox[{"ToString", "@", "blockNum"}], " ", "<>", " ", 
               "\"\<.mx\>\""}], ",", " ", "cgrBlock"}], "]"}], ";", "\n", 
            "\n", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"compute", " ", "descriptors"}], " ", "*)"}], "\n", 
            "\t\t", 
            RowBox[{"descrBlock", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"N", "@", 
                RowBox[{"Descriptor", "[", 
                 RowBox[{
                 "#", ",", " ", "windowsizes", ",", " ", "steps", ",", " ", 
                  "bins"}], "]"}]}], "&"}], " ", "/@", " ", "cgrBlock"}]}], 
            ";", "\n", "\t\t", 
            RowBox[{"DumpSave", "[", 
             RowBox[{
              RowBox[{"\"\<descr-temp_\>\"", " ", "<>", " ", 
               RowBox[{"ToString", "@", "blockNum"}], " ", "<>", " ", 
               "\"\<.mx\>\""}], ",", " ", "descrBlock"}], "]"}], ";"}]}], 
          "\n", "\t", "]"}]}], "\n", ")"}], "&"}], ",", " ", "fileBlocks"}], 
     "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "run", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"PrintTemporary", "[", 
   RowBox[{"Row", "[", "jobs", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Finished in \>\"", ",", " ", 
    RowBox[{"First", "@", 
     RowBox[{"AbsoluteTiming", "@", 
      RowBox[{"WaitAll", "[", "jobs", "]"}]}]}], ",", " ", 
    "\"\< seconds\>\""}], "]"}], ";"}]}], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->False,
 CellChangeTimes->{{3.5900258292727613`*^9, 3.590025864876798*^9}, {
   3.5900955127650194`*^9, 3.590095513239047*^9}, {3.5900957819164143`*^9, 
   3.590095782314437*^9}, {3.5902363331619506`*^9, 3.5902363523919506`*^9}, {
   3.5902363867019506`*^9, 3.590236419901951*^9}, 3.590236792622162*^9, {
   3.5902369522406507`*^9, 3.590236963177806*^9}, 3.5902400160600133`*^9, {
   3.5936323424772806`*^9, 3.593632363014202*^9}, {3.5936324182926917`*^9, 
   3.5936324496073704`*^9}, {3.5937836843046703`*^9, 3.59378370600467*^9}, 
   3.5937841285926704`*^9, 3.5937842077926702`*^9, 3.5937842773926706`*^9, 
   3.5937847924946704`*^9, 3.5937877026566706`*^9, {3.606224159221653*^9, 
   3.606224159901349*^9}, {3.6062243370403347`*^9, 3.6062243371614304`*^9}, {
   3.606225657106229*^9, 3.6062257225053635`*^9}, {3.60622576642638*^9, 
   3.606225793122914*^9}, {3.606225852723591*^9, 3.606225856029044*^9}, {
   3.606225919382411*^9, 3.6062259225159993`*^9}, {3.606226021268468*^9, 
   3.606226025127596*^9}, {3.6073031382875853`*^9, 3.607303138983625*^9}, {
   3.607303216559062*^9, 3.6073032177531304`*^9}, 3.6073033256193*^9, {
   3.60730344135992*^9, 3.607303481655225*^9}, {3.6073037959352007`*^9, 
   3.6073038364805193`*^9}, {3.6073038714175177`*^9, 3.607303894482837*^9}, {
   3.607303971184224*^9, 3.60730404122023*^9}, 3.6073056653291235`*^9, {
   3.607309003204039*^9, 3.6073090160767756`*^9}, 3.6073100917172985`*^9, {
   3.6081560486092997`*^9, 3.6081560506611357`*^9}, {3.608661699748809*^9, 
   3.608661702768301*^9}, {3.608661824598773*^9, 3.6086618581881866`*^9}, {
   3.6086619198045855`*^9, 3.60866192001552*^9}, {3.6086619784405537`*^9, 
   3.60866197914367*^9}, {3.608662925257535*^9, 3.6086629284098377`*^9}, {
   3.6086629949910173`*^9, 3.6086629969441175`*^9}, 3.6086636684166994`*^9, 
   3.60866958673236*^9, {3.6090792132232637`*^9, 3.609079214926367*^9}, {
   3.6090793057259855`*^9, 3.609079317635989*^9}, {3.609079379549259*^9, 
   3.6090793919319134`*^9}, {3.6090794260135083`*^9, 
   3.6090794386344404`*^9}, {3.6090794930478067`*^9, 
   3.6090795693515177`*^9}, {3.6090796289288797`*^9, 3.609079643893532*^9}, {
   3.609079685967212*^9, 3.609079701842009*^9}, {3.60908327054045*^9, 
   3.6090832984932175`*^9}, 3.609083684234865*^9, {3.609090812109707*^9, 
   3.609090852685235*^9}, {3.6090912454540415`*^9, 3.609091372513292*^9}, {
   3.6090914677903967`*^9, 3.60909147144446*^9}, {3.6090916544786434`*^9, 
   3.609091666152701*^9}, {3.609102591541356*^9, 3.6091026105127983`*^9}, {
   3.6091026453142815`*^9, 3.6091026555001526`*^9}, {3.6091028206468096`*^9, 
   3.609102823298007*^9}, {3.609102864123519*^9, 3.6091028646146984`*^9}, {
   3.6091029409359856`*^9, 3.6091029533609715`*^9}, 3.6091176503067074`*^9, {
   3.6093433848395224`*^9, 3.6093434356754303`*^9}, {3.6093438138880625`*^9, 
   3.6093438255527296`*^9}, {3.611683148206684*^9, 3.6116831506986847`*^9}, {
   3.6116835242636843`*^9, 3.6116835348816843`*^9}, {3.6116837963216844`*^9, 
   3.6116838167506847`*^9}, {3.611684487166775*^9, 3.611684506788501*^9}, {
   3.6116845418099985`*^9, 3.6116845522743187`*^9}, {3.6116846688431935`*^9, 
   3.6116846696824455`*^9}, {3.6116849325482063`*^9, 3.611684953764328*^9}, {
   3.611684986159567*^9, 3.6116850213580866`*^9}, 3.611685306197568*^9, {
   3.6116853506790156`*^9, 3.611685396836631*^9}, {3.61168563045399*^9, 
   3.611685658399784*^9}, {3.611685702026147*^9, 3.6116858160765505`*^9}, {
   3.611685917471689*^9, 3.6116860174556866`*^9}, {3.6116861023536606`*^9, 
   3.6116861232696605`*^9}, {3.6116861625396605`*^9, 
   3.6116861831526604`*^9}, {3.6116863379276605`*^9, 
   3.6116863512806606`*^9}, {3.6116864062256603`*^9, 
   3.6116864222216606`*^9}, {3.6116864547196603`*^9, 
   3.6116864567666607`*^9}, {3.6116865929636602`*^9, 
   3.6116866116556606`*^9}, {3.6116867732956605`*^9, 
   3.6116868162696605`*^9}, {3.6116869193236604`*^9, 
   3.6116869323956604`*^9}, {3.6116872521366606`*^9, 
   3.6116872531846604`*^9}, {3.6116873795276604`*^9, 3.61168748328666*^9}, {
   3.6116875254406605`*^9, 3.6116875623436604`*^9}, {3.6116876691726604`*^9, 
   3.61168767755766*^9}, 3.61168774499866*^9, {3.6116878034086604`*^9, 
   3.6116879183656607`*^9}, {3.6116880172766604`*^9, 3.61168808341866*^9}, {
   3.6116891478271055`*^9, 3.6116891782962456`*^9}, {3.61177443206496*^9, 
   3.611774489901165*^9}, 3.613824125133259*^9, {3.6139158193916426`*^9, 
   3.6139158322134237`*^9}, {3.6139158676278696`*^9, 3.613915885323862*^9}, {
   3.6234996208535156`*^9, 3.6234997815429688`*^9}, {3.6234999782822266`*^9, 
   3.6234999806884766`*^9}, {3.6235039762998047`*^9, 
   3.6235040116591797`*^9}, {3.6236027710146484`*^9, 3.6236027911875*^9}, {
   3.623683613275797*^9, 3.6236836135286226`*^9}, 3.6236883945683928`*^9, {
   3.6241591950455503`*^9, 3.624159199572025*^9}, {3.625596809942179*^9, 
   3.625596861539353*^9}, {3.625596917827804*^9, 3.6255969452040377`*^9}, {
   3.625597040103467*^9, 3.6255970426520615`*^9}, {3.6255971168499427`*^9, 
   3.6255971767466307`*^9}, {3.625597275386981*^9, 3.6255972799791427`*^9}, {
   3.625597522386879*^9, 3.6255975332955503`*^9}, {3.625597911882228*^9, 
   3.6255979415146627`*^9}, 3.6255980221379514`*^9, {3.6256200938767233`*^9, 
   3.6256201228041553`*^9}, {3.625621349068861*^9, 3.625621353054782*^9}, {
   3.62562139578977*^9, 3.625621396024145*^9}, {3.625622461713439*^9, 
   3.625622473123191*^9}, {3.62562266637991*^9, 3.6256226664892893`*^9}, 
   3.625623168402526*^9, 3.625623259207557*^9, {3.625715588855285*^9, 
   3.6257156040310893`*^9}, {3.6257159827662497`*^9, 
   3.6257159935244827`*^9}, {3.6257162946957827`*^9, 3.625716307979456*^9}, {
   3.625716350959687*^9, 3.62571642875991*^9}, {3.625716471332182*^9, 
   3.625716482444435*^9}, 3.625716558559552*^9, {3.6257167142918444`*^9, 
   3.6257167176068735`*^9}, 3.6257537662055397`*^9, {3.6257538139635086`*^9, 
   3.625753961272176*^9}, {3.6257540218951573`*^9, 3.6257540342720394`*^9}, {
   3.6257541476397753`*^9, 3.625754150656698*^9}, {3.6257545337829943`*^9, 
   3.625754537955439*^9}, {3.625754616383644*^9, 3.6257546247756896`*^9}, {
   3.625757471084272*^9, 3.625757474335303*^9}, 3.625758796925576*^9, 
   3.6257848028042126`*^9, {3.6257854875954494`*^9, 3.6257854910341225`*^9}, 
   3.6257863383637867`*^9, {3.6307858046312065`*^9, 3.6307858428024206`*^9}, {
   3.630785939515229*^9, 3.6307860417147155`*^9}, {3.6307861562127056`*^9, 
   3.6307862584152174`*^9}, 3.630786587458082*^9, {3.6307871525807695`*^9, 
   3.6307872012045784`*^9}, {3.6307872987811184`*^9, 3.630787306689475*^9}, {
   3.630787634871409*^9, 3.630787668322457*^9}, {3.6307880786983023`*^9, 
   3.630788104089094*^9}, {3.6307881443388557`*^9, 3.6307881453076077`*^9}, {
   3.630788190754453*^9, 3.6307882919370413`*^9}, {3.6307883377536497`*^9, 
   3.630788461295947*^9}, {3.6307885129472713`*^9, 3.6307887639283295`*^9}, {
   3.630788801031342*^9, 3.630788841704488*^9}, {3.6307892201295357`*^9, 
   3.6307892493993645`*^9}, {3.6307895299787707`*^9, 3.630789542692627*^9}, {
   3.630789601091529*^9, 3.6307896461256247`*^9}, {3.630789702543542*^9, 
   3.6307897228066864`*^9}, {3.6307898602861023`*^9, 
   3.6307898645525985`*^9}, {3.630790518014977*^9, 3.6307905533158627`*^9}, 
   3.6307911819992313`*^9, {3.6307912200160046`*^9, 3.630791220515997*^9}, {
   3.630795195015311*^9, 3.6307952708376293`*^9}, 3.630795302520629*^9, {
   3.6307953791197443`*^9, 3.6307954420228815`*^9}, {3.6307989419220333`*^9, 
   3.630798976814109*^9}, {3.630799080208748*^9, 3.6307990822739077`*^9}, {
   3.630799132463772*^9, 3.6307991471750965`*^9}, {3.6307992158168945`*^9, 
   3.6307992874764175`*^9}, 3.630799384840431*^9, {3.6307995230505157`*^9, 
   3.6307995541113377`*^9}, {3.6307997732092867`*^9, 
   3.6307998092423587`*^9}, {3.6308000974516354`*^9, 3.630800100704095*^9}, {
   3.630800262381646*^9, 3.630800262537898*^9}, 3.630800341539998*^9, {
   3.6308003812452188`*^9, 3.630800418266244*^9}, {3.630800457145218*^9, 
   3.6308005489557443`*^9}, {3.6308924847009006`*^9, 3.630892486844637*^9}, {
   3.6309330562900047`*^9, 3.630933106573952*^9}, {3.6309332096798754`*^9, 
   3.630933209726878*^9}, {3.632262565182148*^9, 3.6322625808045444`*^9}, 
   3.632263170467165*^9, 3.6322654957519712`*^9, 3.6322690865188446`*^9, {
   3.6337154955538054`*^9, 3.63371552104425*^9}, {3.633715635454851*^9, 
   3.6337156356264515`*^9}, {3.633715708228979*^9, 3.6337157398970346`*^9}, {
   3.6337158264303865`*^9, 3.633715878050877*^9}, {3.6338071518370132`*^9, 
   3.633807158545025*^9}, {3.6338074266775117`*^9, 3.633807430327918*^9}, {
   3.6338151067142925`*^9, 3.6338152248525023`*^9}, {3.633815255778757*^9, 
   3.6338152967564297`*^9}, {3.633818464155045*^9, 3.6338185755734406`*^9}, {
   3.633818609910101*^9, 3.6338186294589357`*^9}, {3.6338186714562097`*^9, 
   3.6338187078394737`*^9}, {3.6338187678597794`*^9, 3.633818768748981*^9}, {
   3.63381899793017*^9, 3.6338190293826275`*^9}, 3.6338190601010814`*^9, {
   3.633822508411913*^9, 3.633822517149928*^9}, {3.6338258747099557`*^9, 
   3.63382587681596*^9}, {3.63382629347476*^9, 3.6338263356260347`*^9}, {
   3.6338264497558346`*^9, 3.6338264518774385`*^9}, {3.6338266185013313`*^9, 
   3.633826621184536*^9}, {3.633832482931408*^9, 3.633832494040628*^9}, {
   3.6338327329442496`*^9, 3.6338327379704585`*^9}, {3.6338327888229485`*^9, 
   3.6338327968569627`*^9}, 3.6338775757100053`*^9, {3.6338777769147663`*^9, 
   3.633877778427969*^9}, 3.633879166069461*^9, 3.6338801044138637`*^9, 
   3.633880251547326*^9, {3.633881219416033*^9, 3.633881275158931*^9}, 
   3.6338824243577356`*^9, 3.633882544165946*^9, {3.633886049257115*^9, 
   3.633886050239917*^9}, {3.6338922502122755`*^9, 3.6338922652215023`*^9}, {
   3.6340771581216617`*^9, 3.6340771726904945`*^9}, {3.634082674345172*^9, 
   3.63408267466719*^9}, {3.6399243528949013`*^9, 3.639924393472974*^9}, {
   3.6410504522285156`*^9, 3.6410504528603516`*^9}, {3.6419157164716797`*^9, 
   3.641915724758789*^9}, {3.642539641333008*^9, 3.642539644786133*^9}, {
   3.6429494341777344`*^9, 3.642949440169922*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute CPU distances", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
  3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
  3.5900258211132956`*^9}, {3.590027035094731*^9, 3.5900270372298527`*^9}, {
  3.6309347569592323`*^9, 3.630934758927988*^9}, {3.6337168959682646`*^9, 
  3.633716895999465*^9}, {3.6337359984831743`*^9, 3.633736005035186*^9}, {
  3.6338273444754143`*^9, 3.633827346675018*^9}, {3.6429555356972656`*^9, 
  3.6429555363066406`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numFiles", " ", "=", " ", 
   RowBox[{"Length", "@", 
    RowBox[{"FileNames", "[", "\"\<*.fasta\>\"", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numBlocks", " ", "=", " ", 
    RowBox[{"Ceiling", "[", 
     RowBox[{"numFiles", "/", "blockSize"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"queue", " ", "CPU", " ", "jobs"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"LaunchCPUKernels", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jobs", " ", "=", " ", 
    RowBox[{"Table", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"ParallelSubmit", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j"}], "}"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"SetDirectory", "[", "workDir", "]"}], ";", "\n", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"fetch", " ", "descriptor", " ", "blocks"}], " ", "*)"}], 
         "\n", "\t\t", 
         RowBox[{"Get", "[", 
          RowBox[{"\"\<descr-temp_\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<.mx\>\""}], 
          "]"}], ";", "\n", "\t\t", 
         RowBox[{"descrBlock1", " ", "=", " ", "descrBlock"}], ";", "\n", 
         "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "\[Equal]", " ", "j"}], ",", " ", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"descrBlock2", " ", "=", " ", "descrBlock1"}], ";"}], 
           "\n", "\t\t", ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Get", "[", 
             RowBox[{"\"\<descr-temp_\>\"", " ", "<>", " ", 
              RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}],
              "]"}], ";", "\n", "\t\t\t", 
            RowBox[{"descrBlock2", " ", "=", " ", "descrBlock"}], ";"}]}], 
          "\n", "\t\t", "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"(*", "descriptors", "*)"}], "\n", "\t\t", 
         RowBox[{"distBlock", " ", "=", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{
           "EuclideanDistance", ",", " ", "descrBlock1", ",", " ", 
            "descrBlock2", ",", " ", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"DumpSave", "[", 
          RowBox[{
           RowBox[{"\"\<dist-descr_\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ", 
            "<>", " ", 
            RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
           ",", " ", "distBlock"}], "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "descrBlock", ",", " ", "descrBlock1", ",", " ", "descrBlock2"}], 
          "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"fetch", " ", "CGR", " ", "blocks"}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{"Get", "[", 
          RowBox[{"\"\<cgrs_\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<.mx\>\""}], 
          "]"}], ";", "\n", "\t\t", 
         RowBox[{"cgrBlock1", " ", "=", " ", "cgrBlock"}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "\[Equal]", " ", "j"}], ",", " ", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"cgrBlock2", " ", "=", " ", "cgrBlock1"}], ";"}], "\n", 
           "\t\t", ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Get", "[", 
             RowBox[{"\"\<cgrs_\>\"", " ", "<>", " ", 
              RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}],
              "]"}], ";", "\n", "\t\t\t", 
            RowBox[{"cgrBlock2", " ", "=", " ", "cgrBlock"}], ";"}]}], "\n", 
          "\t\t", "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"(*", 
          RowBox[{"approx", " ", "inf", " ", "dist"}], "*)"}], "\n", "\t\t", 
         RowBox[{"distBlock", " ", "=", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{"N", " ", "@*", " ", "ApproxInfoDist"}], ",", " ", 
            "cgrBlock1", ",", " ", "cgrBlock2", ",", " ", "1"}], "]"}]}], ";",
          "\n", "\t\t", 
         RowBox[{"DumpSave", "[", 
          RowBox[{
           RowBox[{"\"\<dist-info_\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ", 
            "<>", " ", 
            RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
           ",", " ", "distBlock"}], "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"cgrBlock1", " ", "=", " ", 
          RowBox[{"Flatten", " ", "/@", " ", "cgrBlock1"}]}], ";", "\n", 
         "\t\t", 
         RowBox[{"cgrBlock2", " ", "=", " ", 
          RowBox[{"Flatten", " ", "/@", " ", "cgrBlock2"}]}], ";", "\n", "\n",
          "\t\t", 
         RowBox[{"(*", "euclidean", "*)"}], "\n", "\t\t", 
         RowBox[{"distBlock", " ", "=", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{
           "EuclideanDistance", ",", " ", "cgrBlock1", ",", " ", "cgrBlock2", 
            ",", " ", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"DumpSave", "[", 
          RowBox[{
           RowBox[{"\"\<dist-euclid_\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ", 
            "<>", " ", 
            RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
           ",", " ", "distBlock"}], "]"}], ";", "\n", "\n", "\t\t", 
         RowBox[{"(*", "manhattan", "*)"}], "\n", "\t\t", 
         RowBox[{"distBlock", " ", "=", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{
           "ManhattanDistance", ",", " ", "cgrBlock1", ",", " ", "cgrBlock2", 
            ",", " ", "1"}], "]"}]}], ";", "\n", "\t\t", 
         RowBox[{"DumpSave", "[", 
          RowBox[{
           RowBox[{"\"\<dist-manhat_\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ", 
            "<>", " ", 
            RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
           ",", " ", "distBlock"}], "]"}], ";"}]}], "\n", "\t", "]"}], "\n", 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "numBlocks"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "i", ",", " ", "numBlocks"}], "}"}]}], "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"run", " ", "CPU", " ", "jobs"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"PrintTemporary", "[", 
   RowBox[{"Grid", "[", "jobs", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Finished CPU work in \>\"", ",", " ", 
    RowBox[{"First", "@", 
     RowBox[{"AbsoluteTiming", "@", 
      RowBox[{"WaitAll", "[", "jobs", "]"}]}]}], ",", " ", 
    "\"\< seconds\>\""}], "]"}], ";"}]}], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->False,
 CellChangeTimes->{{3.5900258292727613`*^9, 3.590025864876798*^9}, 
   3.5900270183007703`*^9, {3.5900282764957347`*^9, 3.590028322430362*^9}, {
   3.5902414858210135`*^9, 3.590241510947013*^9}, {3.5915782938750124`*^9, 
   3.591578301956475*^9}, {3.593632486758211*^9, 3.593632535863612*^9}, {
   3.5936362092073956`*^9, 3.593636216121724*^9}, {3.5937837702846704`*^9, 
   3.5937838003746705`*^9}, {3.5937838500396705`*^9, 
   3.5937838683446703`*^9}, {3.5937839044436703`*^9, 
   3.5937839108856707`*^9}, {3.5937841113706703`*^9, 
   3.5937841233196707`*^9}, {3.605472529764188*^9, 3.6054725375595875`*^9}, {
   3.607305745289697*^9, 3.6073057473508153`*^9}, {3.6073059120572357`*^9, 
   3.607305922876855*^9}, 3.6073059841483593`*^9, {3.607306098763915*^9, 
   3.6073062552208633`*^9}, {3.6073063421708364`*^9, 
   3.6073063454430237`*^9}, {3.607554758800976*^9, 3.607554795257061*^9}, 
   3.607559631009574*^9, 3.6076108013185053`*^9, 3.6076134268115053`*^9, 
   3.6076161126625056`*^9, {3.6076186921545057`*^9, 3.6076186926745057`*^9}, {
   3.607621908192966*^9, 3.607621908643056*^9}, 3.6076238187172375`*^9, 
   3.6076312548837795`*^9, {3.6081438905927176`*^9, 3.6081439020163713`*^9}, {
   3.6081502610180855`*^9, 3.6081502614941125`*^9}, {3.60815595108407*^9, 
   3.608155953979689*^9}, 3.6081583171398177`*^9, {3.6082972295548964`*^9, 
   3.6082972392759542`*^9}, {3.609116359475876*^9, 3.6091164448417587`*^9}, {
   3.6091165263434205`*^9, 3.609116661959177*^9}, 3.6091166945440407`*^9, {
   3.609116844870639*^9, 3.609116851483017*^9}, {3.6091177329544344`*^9, 
   3.6091177348535433`*^9}, 3.6091178103788633`*^9, 3.609122850706523*^9, {
   3.6091238246522694`*^9, 3.60912383435527*^9}, {3.609125958080989*^9, 
   3.609126033575014*^9}, {3.6091260834538713`*^9, 3.6091261406763525`*^9}, 
   3.6091715992773485`*^9, 3.6091871571201878`*^9, {3.609196447795721*^9, 
   3.609196465595746*^9}, {3.609196867745411*^9, 3.6091968692493362`*^9}, {
   3.6092013301985865`*^9, 3.609201336658596*^9}, {3.6094335199723835`*^9, 
   3.609433597580839*^9}, {3.611689256163521*^9, 3.611689290229491*^9}, {
   3.611689343135064*^9, 3.611689372447189*^9}, {3.6116895266236343`*^9, 
   3.6116895341075306`*^9}, {3.6117746141002703`*^9, 3.611774730464113*^9}, {
   3.611791893632397*^9, 3.611791902868103*^9}, {3.6118035988530097`*^9, 
   3.611803677256225*^9}, {3.611806530794865*^9, 3.611806570438966*^9}, {
   3.611839938737218*^9, 3.6118399585787215`*^9}, {3.611853480294531*^9, 
   3.611853500203499*^9}, {3.611855294554266*^9, 3.6118552947447033`*^9}, {
   3.6119435065855017`*^9, 3.6119435779986424`*^9}, {3.611943628807723*^9, 
   3.6119436407449164`*^9}, {3.6119443165314884`*^9, 
   3.6119444490987434`*^9}, {3.611945085198349*^9, 3.6119450973775663`*^9}, {
   3.6119661464339542`*^9, 3.611966245276439*^9}, 3.611966414858908*^9, {
   3.611969417250207*^9, 3.6119694346714134`*^9}, {3.611969565254303*^9, 
   3.611969571467635*^9}, {3.6127100776920705`*^9, 3.612710088770463*^9}, {
   3.6138153681202445`*^9, 3.613815386663925*^9}, {3.6140158001708803`*^9, 
   3.6140158095335445`*^9}, {3.615530484380446*^9, 3.615530494170446*^9}, {
   3.6237744253375897`*^9, 3.6237744331181397`*^9}, {3.6237748486970053`*^9, 
   3.623774848837199*^9}, {3.62377508050051*^9, 3.6237751059472227`*^9}, {
   3.6237752411591787`*^9, 3.6237752473143845`*^9}, {3.624159472456005*^9, 
   3.6241594924009275`*^9}, 3.6256039003264575`*^9, {3.6256150436615276`*^9, 
   3.62561510773934*^9}, {3.625615143058735*^9, 3.625615168957562*^9}, {
   3.6256152636082916`*^9, 3.6256153257078605`*^9}, {3.62561540401682*^9, 
   3.625615532226846*^9}, {3.6256156358579335`*^9, 3.6256156436410484`*^9}, {
   3.62561572754963*^9, 3.6256158548876963`*^9}, {3.6256189664294167`*^9, 
   3.625618968820465*^9}, {3.625619272132119*^9, 3.625619286831154*^9}, {
   3.625619636200493*^9, 3.625619669987542*^9}, {3.625619743131459*^9, 
   3.6256197469764147`*^9}, {3.6256198077357855`*^9, 
   3.6256198168785706`*^9}, {3.625619879063693*^9, 3.6256199224491253`*^9}, 
   3.6256200350542808`*^9, {3.6256222336939516`*^9, 3.6256223880749235`*^9}, {
   3.6256246995815153`*^9, 3.6256247130533996`*^9}, {3.625624807907028*^9, 
   3.6256248438332653`*^9}, {3.6256248912363667`*^9, 
   3.6256249411703367`*^9}, {3.6256251976080885`*^9, 3.625625199952308*^9}, {
   3.6256252905542665`*^9, 3.62562530671898*^9}, {3.625626937526267*^9, 
   3.6256269426051025`*^9}, {3.6257072632098646`*^9, 3.625707269898923*^9}, {
   3.625707591388418*^9, 3.6257075968583107`*^9}, {3.625707978898925*^9, 
   3.625707984431001*^9}, {3.625708242233004*^9, 3.625708250686993*^9}, {
   3.625709393351859*^9, 3.6257093996507816`*^9}, {3.625709561931332*^9, 
   3.6257095682133627`*^9}, {3.6257099509132943`*^9, 
   3.6257099580244484`*^9}, {3.6257105222084746`*^9, 3.625710527915139*^9}, {
   3.6257146535958815`*^9, 3.625714658987034*^9}, {3.6257148417704887`*^9, 
   3.6257148526796026`*^9}, {3.6257151514278007`*^9, 
   3.6257151576945596`*^9}, {3.6257156145491133`*^9, 
   3.6257156187370424`*^9}, {3.625717691109748*^9, 3.6257176964852057`*^9}, {
   3.6257536542038527`*^9, 3.6257536694560475`*^9}, {3.6257541677542257`*^9, 
   3.6257541864551697`*^9}, {3.625754496101023*^9, 3.6257545085871973`*^9}, {
   3.625755541515172*^9, 3.6257555513337364`*^9}, {3.6257560264778347`*^9, 
   3.625756036573777*^9}, {3.6257572361941605`*^9, 3.6257572399298296`*^9}, {
   3.6257576752251916`*^9, 3.6257576795070915`*^9}, {3.625758573047239*^9, 
   3.6257585810643296`*^9}, {3.6257587388200054`*^9, 3.62575874384241*^9}, {
   3.6257597122447376`*^9, 3.625759717182723*^9}, {3.6257599005788116`*^9, 
   3.6257599055951405`*^9}, {3.625760760895819*^9, 3.6257607660373983`*^9}, {
   3.6257608550899057`*^9, 3.625760859356406*^9}, {3.625784814736318*^9, 
   3.6257848199713683`*^9}, {3.6257857927065363`*^9, 3.625785796691456*^9}, {
   3.6257859713745346`*^9, 3.6257859800819893`*^9}, {3.625786359040544*^9, 
   3.625786364588752*^9}, {3.630791439528532*^9, 3.6307915064400997`*^9}, {
   3.630791549794099*^9, 3.6307915695502396`*^9}, {3.630791656964875*^9, 
   3.6307916598402195`*^9}, {3.63079175342338*^9, 3.6307917698756666`*^9}, {
   3.6307918001587577`*^9, 3.630791812891599*^9}, {3.630792313216737*^9, 
   3.630792345194787*^9}, {3.6307923961767874`*^9, 3.630792398958863*^9}, {
   3.630793142662013*^9, 3.6307932258692093`*^9}, {3.630793269765858*^9, 
   3.630793279536368*^9}, {3.6307934567439685`*^9, 3.630793708877591*^9}, {
   3.630794878303548*^9, 3.630795051922011*^9}, {3.630795573263891*^9, 
   3.6307955768399343`*^9}, {3.6307956537470474`*^9, 
   3.6307956859232693`*^9}, {3.6307957270286837`*^9, 
   3.6307957356503825`*^9}, {3.6307957891456623`*^9, 
   3.6307957995574894`*^9}, {3.630795855691593*^9, 3.630795896896716*^9}, {
   3.630796060853955*^9, 3.6307961090662966`*^9}, {3.6307961720070515`*^9, 
   3.6307961987549286`*^9}, {3.6307962768304157`*^9, 3.630796458254304*^9}, {
   3.63079651575645*^9, 3.6307965192743144`*^9}, {3.63079670045982*^9, 
   3.6307967039011564`*^9}, {3.6307967957669983`*^9, 
   3.6307967959701166`*^9}, {3.6307969025165005`*^9, 3.630796912456335*^9}, {
   3.6307969553059874`*^9, 3.6307969573219023`*^9}, {3.6307973114396653`*^9, 
   3.6307973217555003`*^9}, {3.6307974365350733`*^9, 3.630797439478796*^9}, {
   3.6307977096222415`*^9, 3.63079771461226*^9}, {3.6307978162661085`*^9, 
   3.6307978219403553`*^9}, {3.6307979289188037`*^9, 3.630797929121971*^9}, {
   3.630798093034446*^9, 3.6307980958784204`*^9}, {3.6308880481858697`*^9, 
   3.630888296698237*^9}, {3.630888370913756*^9, 3.630888418439316*^9}, {
   3.630888454681615*^9, 3.6308884849460993`*^9}, {3.6308885417581053`*^9, 
   3.630888551434023*^9}, {3.6308898281547375`*^9, 3.630889842870592*^9}, {
   3.6308918258153877`*^9, 3.6308918405382605`*^9}, {3.630892282637442*^9, 
   3.6308923035377216`*^9}, {3.6308925031718016`*^9, 
   3.6308925041874185`*^9}, {3.630893123967134*^9, 3.6308931578292766`*^9}, {
   3.6308932313511705`*^9, 3.630893315424046*^9}, {3.63093322316965*^9, 
   3.630933223217653*^9}, {3.6322668581899834`*^9, 3.632266922456623*^9}, {
   3.6322670239848356`*^9, 3.6322670535458612`*^9}, {3.632267200826503*^9, 
   3.632267225192339*^9}, {3.632267457649988*^9, 3.632267458853531*^9}, {
   3.632267603369564*^9, 3.6322676055260954`*^9}, {3.6322680988494043`*^9, 
   3.6322681072992067`*^9}, 3.6322690923694324`*^9, 3.63227518090088*^9, {
   3.633638376388468*^9, 3.6336385917187805`*^9}, 3.6336386711441517`*^9, {
   3.6336388037510424`*^9, 3.63363883010313*^9}, {3.6336522137169294`*^9, 
   3.6336522268298025`*^9}, {3.6337147912846584`*^9, 3.633714799489453*^9}, {
   3.633715917924547*^9, 3.63371608447044*^9}, 3.633716125030511*^9, {
   3.6337165131123924`*^9, 3.6337165430020447`*^9}, {3.6337359984831743`*^9, 
   3.633736021805215*^9}, 3.63382729670813*^9, {3.6338273501850243`*^9, 
   3.6338273505438247`*^9}, {3.633832512825061*^9, 3.6338325858003902`*^9}, {
   3.6338779235614243`*^9, 3.633877953716277*^9}, {3.633881313909399*^9, 
   3.6338814388812184`*^9}, {3.6338826111836634`*^9, 
   3.6338826570165443`*^9}, {3.633882730211873*^9, 3.633882733144678*^9}, {
   3.6338830237263885`*^9, 3.6338830243347893`*^9}, {3.6338835622355537`*^9, 
   3.633883667566939*^9}, {3.6338854094563904`*^9, 3.6338854645868874`*^9}, {
   3.6338860717055545`*^9, 3.6338860727819567`*^9}, {3.633892271414713*^9, 
   3.633892272085514*^9}, {3.639924440710658*^9, 3.6399244877943563`*^9}, {
   3.6410500702998047`*^9, 3.6410500705302734`*^9}, {3.641905689591797*^9, 
   3.641905876114258*^9}, {3.641905946821289*^9, 3.641906092421875*^9}, {
   3.6419061648271484`*^9, 3.6419062107558594`*^9}, {3.641906378022461*^9, 
   3.6419064347265625`*^9}, 3.6419064854121094`*^9, {3.642517954553711*^9, 
   3.6425180049609375`*^9}, {3.642518039583008*^9, 3.642518104319336*^9}, {
   3.6425182239853516`*^9, 3.6425182264873047`*^9}, {3.642539667754883*^9, 
   3.642539681770508*^9}, {3.642540155551758*^9, 3.642540167754883*^9}, {
   3.6429494665507812`*^9, 3.6429495716816406`*^9}, {3.642955548901367*^9, 
   3.642955549338867*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute GPU distances", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
  3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
  3.5900258211132956`*^9}, {3.590027035094731*^9, 3.5900270372298527`*^9}, {
  3.6309347569592323`*^9, 3.630934758927988*^9}, {3.6337168959682646`*^9, 
  3.633716895999465*^9}, {3.6337359984831743`*^9, 3.633736005035186*^9}, {
  3.6338273444754143`*^9, 3.633827346675018*^9}, {3.6429555274160156`*^9, 
  3.6429555312441406`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numFiles", " ", "=", " ", 
   RowBox[{"Length", "@", 
    RowBox[{"FileNames", "[", "\"\<*.fasta\>\"", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numBlocks", " ", "=", " ", 
    RowBox[{"Ceiling", "[", 
     RowBox[{"numFiles", "/", "blockSize"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"queue", " ", "GPU", " ", "work"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"LaunchGPUKernels", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"jobs", " ", "=", " ", 
    RowBox[{"Table", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"ParallelSubmit", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "j"}], "}"}], ",", "\n", "\t\t", 
        RowBox[{
         RowBox[{"SetDirectory", "[", "workDir", "]"}], ";", "\n", "\n", 
         "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"fetch", " ", "CGR", " ", "blocks"}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{"Get", "[", 
          RowBox[{"\"\<cgrs_\>\"", " ", "<>", " ", 
           RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<.mx\>\""}], 
          "]"}], ";", "\n", "\t\t", 
         RowBox[{"cgrBlock1", " ", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"CUDAMemoryLoad", "[", 
             RowBox[{"#", ",", " ", "\"\<Integer32\>\""}], "]"}], "&"}], " ", 
           "/@", " ", "cgrBlock"}]}], ";", "\n", "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "\[Equal]", " ", "j"}], ",", " ", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"cgrBlock2", " ", "=", " ", "cgrBlock1"}], ";"}], "\n", 
           "\t\t", ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Get", "[", 
             RowBox[{"\"\<cgrs_\>\"", " ", "<>", " ", 
              RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}],
              "]"}], ";", "\n", "\t\t\t", 
            RowBox[{"cgrBlock2", " ", "=", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"CUDAMemoryLoad", "[", 
                RowBox[{"#", ",", " ", "\"\<Integer32\>\""}], "]"}], "&"}], 
              " ", "/@", " ", "cgrBlock"}]}], ";"}]}], "\n", "\t\t", "]"}], 
         ";", "\n", "\n", "\t\t", 
         RowBox[{"(*", "DSSIM", "*)"}], "\n", "\t\t", 
         RowBox[{"distBlock", " ", "=", " ", 
          RowBox[{"Outer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", " ", "-", " ", 
               RowBox[{"CUDASSIM", "[", 
                RowBox[{"#1", ",", " ", "#2"}], "]"}]}], ")"}], "&"}], ",", 
            " ", "cgrBlock1", ",", " ", "cgrBlock2", ",", " ", "1"}], "]"}]}],
          ";", "\n", "\t\t", 
         RowBox[{"DumpSave", "[", 
          RowBox[{
           RowBox[{"\"\<dist-ssim_\>\"", " ", "<>", " ", 
            RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ", 
            "<>", " ", 
            RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
           ",", " ", "distBlock"}], "]"}], ";", "\n", "\t\t", "\n", "\t\t", 
         RowBox[{"(*", 
          RowBox[{"unload", " ", "CGRs", " ", "from", " ", "GPU"}], "*)"}], 
         "\n", "\t\t", 
         RowBox[{"CUDAMemoryUnload", " ", "/@", " ", "cgrBlock1"}], ";", "\n",
          "\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", " ", "\[NotEqual]", " ", "j"}], ",", " ", "\n", 
           "\t\t\t", 
           RowBox[{
            RowBox[{"CUDAMemoryUnload", " ", "/@", " ", "cgrBlock2"}], 
            ";"}]}], "\n", "\t\t", "]"}], ";"}]}], "\n", "\t", "]"}], "\n", 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", "numBlocks"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "i", ",", " ", "numBlocks"}], "}"}]}], "]"}]}], 
   ";"}], "\n", "\n", 
  RowBox[{"(*", " ", "run", " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"PrintTemporary", "[", 
   RowBox[{"Grid", "[", "jobs", "]"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Finished GPU work in \>\"", ",", " ", 
    RowBox[{"First", "@", 
     RowBox[{"AbsoluteTiming", "@", 
      RowBox[{"WaitAll", "[", "jobs", "]"}]}]}], ",", " ", 
    "\"\< seconds\>\""}], "]"}], ";"}]}], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->False,
 CellChangeTimes->{{3.5900258292727613`*^9, 3.590025864876798*^9}, 
   3.5900270183007703`*^9, {3.5900282764957347`*^9, 3.590028322430362*^9}, {
   3.5902414858210135`*^9, 3.590241510947013*^9}, {3.5915782938750124`*^9, 
   3.591578301956475*^9}, {3.593632486758211*^9, 3.593632535863612*^9}, {
   3.5936362092073956`*^9, 3.593636216121724*^9}, {3.5937837702846704`*^9, 
   3.5937838003746705`*^9}, {3.5937838500396705`*^9, 
   3.5937838683446703`*^9}, {3.5937839044436703`*^9, 
   3.5937839108856707`*^9}, {3.5937841113706703`*^9, 
   3.5937841233196707`*^9}, {3.605472529764188*^9, 3.6054725375595875`*^9}, {
   3.607305745289697*^9, 3.6073057473508153`*^9}, {3.6073059120572357`*^9, 
   3.607305922876855*^9}, 3.6073059841483593`*^9, {3.607306098763915*^9, 
   3.6073062552208633`*^9}, {3.6073063421708364`*^9, 
   3.6073063454430237`*^9}, {3.607554758800976*^9, 3.607554795257061*^9}, 
   3.607559631009574*^9, 3.6076108013185053`*^9, 3.6076134268115053`*^9, 
   3.6076161126625056`*^9, {3.6076186921545057`*^9, 3.6076186926745057`*^9}, {
   3.607621908192966*^9, 3.607621908643056*^9}, 3.6076238187172375`*^9, 
   3.6076312548837795`*^9, {3.6081438905927176`*^9, 3.6081439020163713`*^9}, {
   3.6081502610180855`*^9, 3.6081502614941125`*^9}, {3.60815595108407*^9, 
   3.608155953979689*^9}, 3.6081583171398177`*^9, {3.6082972295548964`*^9, 
   3.6082972392759542`*^9}, {3.609116359475876*^9, 3.6091164448417587`*^9}, {
   3.6091165263434205`*^9, 3.609116661959177*^9}, 3.6091166945440407`*^9, {
   3.609116844870639*^9, 3.609116851483017*^9}, {3.6091177329544344`*^9, 
   3.6091177348535433`*^9}, 3.6091178103788633`*^9, 3.609122850706523*^9, {
   3.6091238246522694`*^9, 3.60912383435527*^9}, {3.609125958080989*^9, 
   3.609126033575014*^9}, {3.6091260834538713`*^9, 3.6091261406763525`*^9}, 
   3.6091715992773485`*^9, 3.6091871571201878`*^9, {3.609196447795721*^9, 
   3.609196465595746*^9}, {3.609196867745411*^9, 3.6091968692493362`*^9}, {
   3.6092013301985865`*^9, 3.609201336658596*^9}, {3.6094335199723835`*^9, 
   3.609433597580839*^9}, {3.611689256163521*^9, 3.611689290229491*^9}, {
   3.611689343135064*^9, 3.611689372447189*^9}, {3.6116895266236343`*^9, 
   3.6116895341075306`*^9}, {3.6117746141002703`*^9, 3.611774730464113*^9}, {
   3.611791893632397*^9, 3.611791902868103*^9}, {3.6118035988530097`*^9, 
   3.611803677256225*^9}, {3.611806530794865*^9, 3.611806570438966*^9}, {
   3.611839938737218*^9, 3.6118399585787215`*^9}, {3.611853480294531*^9, 
   3.611853500203499*^9}, {3.611855294554266*^9, 3.6118552947447033`*^9}, {
   3.6119435065855017`*^9, 3.6119435779986424`*^9}, {3.611943628807723*^9, 
   3.6119436407449164`*^9}, {3.6119443165314884`*^9, 
   3.6119444490987434`*^9}, {3.611945085198349*^9, 3.6119450973775663`*^9}, {
   3.6119661464339542`*^9, 3.611966245276439*^9}, 3.611966414858908*^9, {
   3.611969417250207*^9, 3.6119694346714134`*^9}, {3.611969565254303*^9, 
   3.611969571467635*^9}, {3.6127100776920705`*^9, 3.612710088770463*^9}, {
   3.6138153681202445`*^9, 3.613815386663925*^9}, {3.6140158001708803`*^9, 
   3.6140158095335445`*^9}, {3.615530484380446*^9, 3.615530494170446*^9}, {
   3.6237744253375897`*^9, 3.6237744331181397`*^9}, {3.6237748486970053`*^9, 
   3.623774848837199*^9}, {3.62377508050051*^9, 3.6237751059472227`*^9}, {
   3.6237752411591787`*^9, 3.6237752473143845`*^9}, {3.624159472456005*^9, 
   3.6241594924009275`*^9}, 3.6256039003264575`*^9, {3.6256150436615276`*^9, 
   3.62561510773934*^9}, {3.625615143058735*^9, 3.625615168957562*^9}, {
   3.6256152636082916`*^9, 3.6256153257078605`*^9}, {3.62561540401682*^9, 
   3.625615532226846*^9}, {3.6256156358579335`*^9, 3.6256156436410484`*^9}, {
   3.62561572754963*^9, 3.6256158548876963`*^9}, {3.6256189664294167`*^9, 
   3.625618968820465*^9}, {3.625619272132119*^9, 3.625619286831154*^9}, {
   3.625619636200493*^9, 3.625619669987542*^9}, {3.625619743131459*^9, 
   3.6256197469764147`*^9}, {3.6256198077357855`*^9, 
   3.6256198168785706`*^9}, {3.625619879063693*^9, 3.6256199224491253`*^9}, 
   3.6256200350542808`*^9, {3.6256222336939516`*^9, 3.6256223880749235`*^9}, {
   3.6256246995815153`*^9, 3.6256247130533996`*^9}, {3.625624807907028*^9, 
   3.6256248438332653`*^9}, {3.6256248912363667`*^9, 
   3.6256249411703367`*^9}, {3.6256251976080885`*^9, 3.625625199952308*^9}, {
   3.6256252905542665`*^9, 3.62562530671898*^9}, {3.625626937526267*^9, 
   3.6256269426051025`*^9}, {3.6257072632098646`*^9, 3.625707269898923*^9}, {
   3.625707591388418*^9, 3.6257075968583107`*^9}, {3.625707978898925*^9, 
   3.625707984431001*^9}, {3.625708242233004*^9, 3.625708250686993*^9}, {
   3.625709393351859*^9, 3.6257093996507816`*^9}, {3.625709561931332*^9, 
   3.6257095682133627`*^9}, {3.6257099509132943`*^9, 
   3.6257099580244484`*^9}, {3.6257105222084746`*^9, 3.625710527915139*^9}, {
   3.6257146535958815`*^9, 3.625714658987034*^9}, {3.6257148417704887`*^9, 
   3.6257148526796026`*^9}, {3.6257151514278007`*^9, 
   3.6257151576945596`*^9}, {3.6257156145491133`*^9, 
   3.6257156187370424`*^9}, {3.625717691109748*^9, 3.6257176964852057`*^9}, {
   3.6257536542038527`*^9, 3.6257536694560475`*^9}, {3.6257541677542257`*^9, 
   3.6257541864551697`*^9}, {3.625754496101023*^9, 3.6257545085871973`*^9}, {
   3.625755541515172*^9, 3.6257555513337364`*^9}, {3.6257560264778347`*^9, 
   3.625756036573777*^9}, {3.6257572361941605`*^9, 3.6257572399298296`*^9}, {
   3.6257576752251916`*^9, 3.6257576795070915`*^9}, {3.625758573047239*^9, 
   3.6257585810643296`*^9}, {3.6257587388200054`*^9, 3.62575874384241*^9}, {
   3.6257597122447376`*^9, 3.625759717182723*^9}, {3.6257599005788116`*^9, 
   3.6257599055951405`*^9}, {3.625760760895819*^9, 3.6257607660373983`*^9}, {
   3.6257608550899057`*^9, 3.625760859356406*^9}, {3.625784814736318*^9, 
   3.6257848199713683`*^9}, {3.6257857927065363`*^9, 3.625785796691456*^9}, {
   3.6257859713745346`*^9, 3.6257859800819893`*^9}, {3.625786359040544*^9, 
   3.625786364588752*^9}, {3.630791439528532*^9, 3.6307915064400997`*^9}, {
   3.630791549794099*^9, 3.6307915695502396`*^9}, {3.630791656964875*^9, 
   3.6307916598402195`*^9}, {3.63079175342338*^9, 3.6307917698756666`*^9}, {
   3.6307918001587577`*^9, 3.630791812891599*^9}, {3.630792313216737*^9, 
   3.630792345194787*^9}, {3.6307923961767874`*^9, 3.630792398958863*^9}, {
   3.630793142662013*^9, 3.6307932258692093`*^9}, {3.630793269765858*^9, 
   3.630793279536368*^9}, {3.6307934567439685`*^9, 3.630793708877591*^9}, {
   3.630794878303548*^9, 3.630795051922011*^9}, {3.630795573263891*^9, 
   3.6307955768399343`*^9}, {3.6307956537470474`*^9, 
   3.6307956859232693`*^9}, {3.6307957270286837`*^9, 
   3.6307957356503825`*^9}, {3.6307957891456623`*^9, 
   3.6307957995574894`*^9}, {3.630795855691593*^9, 3.630795896896716*^9}, {
   3.630796060853955*^9, 3.6307961090662966`*^9}, {3.6307961720070515`*^9, 
   3.6307961987549286`*^9}, {3.6307962768304157`*^9, 3.630796458254304*^9}, {
   3.63079651575645*^9, 3.6307965192743144`*^9}, {3.63079670045982*^9, 
   3.6307967039011564`*^9}, {3.6307967957669983`*^9, 
   3.6307967959701166`*^9}, {3.6307969025165005`*^9, 3.630796912456335*^9}, {
   3.6307969553059874`*^9, 3.6307969573219023`*^9}, {3.6307973114396653`*^9, 
   3.6307973217555003`*^9}, {3.6307974365350733`*^9, 3.630797439478796*^9}, {
   3.6307977096222415`*^9, 3.63079771461226*^9}, {3.6307978162661085`*^9, 
   3.6307978219403553`*^9}, {3.6307979289188037`*^9, 3.630797929121971*^9}, {
   3.630798093034446*^9, 3.6307980958784204`*^9}, {3.6308880481858697`*^9, 
   3.630888296698237*^9}, {3.630888370913756*^9, 3.630888418439316*^9}, {
   3.630888454681615*^9, 3.6308884849460993`*^9}, {3.6308885417581053`*^9, 
   3.630888551434023*^9}, {3.6308898281547375`*^9, 3.630889842870592*^9}, {
   3.6308918258153877`*^9, 3.6308918405382605`*^9}, {3.630892282637442*^9, 
   3.6308923035377216`*^9}, {3.6308925031718016`*^9, 
   3.6308925041874185`*^9}, {3.630893123967134*^9, 3.6308931578292766`*^9}, {
   3.6308932313511705`*^9, 3.630893315424046*^9}, {3.63093322316965*^9, 
   3.630933223217653*^9}, {3.6322668581899834`*^9, 3.632266922456623*^9}, {
   3.6322670239848356`*^9, 3.6322670535458612`*^9}, {3.632267200826503*^9, 
   3.632267225192339*^9}, {3.632267457649988*^9, 3.632267458853531*^9}, {
   3.632267603369564*^9, 3.6322676055260954`*^9}, {3.6322680988494043`*^9, 
   3.6322681072992067`*^9}, 3.6322690923694324`*^9, 3.63227518090088*^9, {
   3.633638376388468*^9, 3.6336385917187805`*^9}, 3.6336386711441517`*^9, {
   3.6336388037510424`*^9, 3.63363883010313*^9}, {3.6336522137169294`*^9, 
   3.6336522268298025`*^9}, {3.6337147912846584`*^9, 3.633714799489453*^9}, {
   3.633715917924547*^9, 3.63371608447044*^9}, 3.633716125030511*^9, {
   3.6337165131123924`*^9, 3.6337165430020447`*^9}, {3.6337359984831743`*^9, 
   3.633736021805215*^9}, 3.63382729670813*^9, {3.6338273501850243`*^9, 
   3.6338273505438247`*^9}, {3.633832512825061*^9, 3.6338325858003902`*^9}, {
   3.6338779235614243`*^9, 3.633877953716277*^9}, {3.633881313909399*^9, 
   3.6338814388812184`*^9}, {3.6338826111836634`*^9, 
   3.6338826570165443`*^9}, {3.633882730211873*^9, 3.633882733144678*^9}, {
   3.6338830237263885`*^9, 3.6338830243347893`*^9}, {3.6338835622355537`*^9, 
   3.633883667566939*^9}, {3.6338854094563904`*^9, 3.6338854645868874`*^9}, {
   3.6338860717055545`*^9, 3.6338860727819567`*^9}, {3.633892271414713*^9, 
   3.633892272085514*^9}, {3.639924440710658*^9, 3.6399244877943563`*^9}, {
   3.6410500702998047`*^9, 3.6410500705302734`*^9}, {3.641905689591797*^9, 
   3.641905876114258*^9}, {3.641905946821289*^9, 3.641906092421875*^9}, {
   3.6419061648271484`*^9, 3.6419062107558594`*^9}, {3.641906378022461*^9, 
   3.6419064347265625`*^9}, 3.6419064854121094`*^9, {3.642517954553711*^9, 
   3.6425180049609375`*^9}, {3.642518039583008*^9, 3.642518104319336*^9}, {
   3.6425182239853516`*^9, 3.6425182264873047`*^9}, {3.642539667754883*^9, 
   3.642539681770508*^9}, {3.642540155551758*^9, 3.642540167754883*^9}, {
   3.6429494665507812`*^9, 3.6429495716816406`*^9}, 3.6429555274160156`*^9, {
   3.642955572385742*^9, 3.642955572745117*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Merge distance blocks", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
   3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
   3.5900258211132956`*^9}, {3.590027035094731*^9, 3.5900270372298527`*^9}, {
   3.6309347569592323`*^9, 3.630934758927988*^9}, {3.6337168959682646`*^9, 
   3.633716895999465*^9}, {3.6337359984831743`*^9, 3.633736005035186*^9}, 
   3.633827340856208*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"numFiles", " ", "=", " ", 
   RowBox[{"Length", "@", 
    RowBox[{"FileNames", "[", "\"\<*.fasta\>\"", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numBlocks", " ", "=", " ", 
    RowBox[{"Ceiling", "[", 
     RowBox[{"numFiles", "/", "blockSize"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", "\n", "\t", 
       RowBox[{
        RowBox[{"distName", " ", "=", " ", "#"}], ";", "\n", "\t", 
        RowBox[{"dists", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"numFiles", ",", " ", "numFiles"}], "}"}]}], "]"}]}], ";",
         " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "this", " ", "will", " ", "hold", " ", "the", " ", "output", " ", 
          "distance", " ", "matrix"}], " ", "*)"}], "\n", "\n", "\t", 
        RowBox[{"SetDirectory", "[", "workDir", "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\n", "\t\t", 
         RowBox[{"(*", " ", 
          RowBox[{"fetch", " ", "the", " ", "submatrix"}], " ", "*)"}], "\n", 
         "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Get", "[", 
            RowBox[{"distName", " ", "<>", " ", "\"\<_\>\"", " ", "<>", " ", 
             RowBox[{"ToString", "@", "i"}], " ", "<>", " ", "\"\<_\>\"", " ",
              "<>", " ", 
             RowBox[{"ToString", "@", "j"}], " ", "<>", " ", "\"\<.mx\>\""}], 
            "]"}], ";", "\n", "\t ", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "we", " ", "replace", " ", "the", " ", "block", " ", "from", " ", 
              RowBox[{"(", 
               RowBox[{"i1", ",", " ", "j1"}], ")"}], " ", "to", " ", 
              RowBox[{"(", 
               RowBox[{"i2", ",", " ", "j2"}], ")"}]}], " ", "-", " ", 
             RowBox[{"first", " ", "the", " ", "top", " ", "part"}]}], " ", 
            "*)"}], "\n", "\t\t", 
           RowBox[{"i1", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"i", " ", "-", " ", "1"}], ")"}], " ", "*", " ", 
              "blockSize"}], " ", "+", " ", "1"}]}], ";", "\n", "\t\t", 
           RowBox[{"i2", " ", "=", " ", 
            RowBox[{"i1", " ", "+", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", "distBlock", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], ";", 
           "\n", "\t\t", 
           RowBox[{"j1", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"j", " ", "-", " ", "1"}], ")"}], " ", "*", " ", 
              "blockSize"}], " ", "+", " ", "1"}]}], ";", "\n", "\t\t", 
           RowBox[{"j2", " ", "=", " ", 
            RowBox[{"j1", " ", "+", " ", 
             RowBox[{
              RowBox[{"Dimensions", "[", "distBlock", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", "1"}]}], ";", 
           "\n", "\t ", "\n", "\t\t", 
           RowBox[{
            RowBox[{"dists", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i1", " ", ";;", " ", "i2"}], ",", " ", 
               RowBox[{"j1", " ", ";;", " ", "j2"}]}], "]"}], "]"}], " ", "=",
             " ", "distBlock"}], ";", "\n", "\t ", "\n", "\t\t", 
           RowBox[{"(*", " ", 
            RowBox[{"now", " ", "the", " ", "bottom", " ", "part"}], " ", 
            "*)"}], "\n", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", " ", "!=", " ", "j"}], ",", " ", "\n", "\t\t\t", 
             RowBox[{
              RowBox[{"i1", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"j", " ", "-", " ", "1"}], ")"}], " ", "*", " ", 
                 "blockSize"}], " ", "+", " ", "1"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"i2", " ", "=", " ", 
               RowBox[{"i1", " ", "+", " ", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "distBlock", "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}], " ", "-", " ", "1"}]}], ";", 
              "\n", "\t\t\t", 
              RowBox[{"j1", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", " ", "-", " ", "1"}], ")"}], " ", "*", " ", 
                 "blockSize"}], " ", "+", " ", "1"}]}], ";", "\n", "\t\t\t", 
              RowBox[{"j2", " ", "=", " ", 
               RowBox[{"j1", " ", "+", " ", 
                RowBox[{
                 RowBox[{"Dimensions", "[", "distBlock", "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}]}], ";", 
              "\n", "\t  ", "\n", "\t\t\t", 
              RowBox[{
               RowBox[{"dists", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i1", " ", ";;", " ", "i2"}], ",", " ", 
                  RowBox[{"j1", " ", ";;", " ", "j2"}]}], "]"}], "]"}], " ", 
               "=", " ", 
               RowBox[{"Transpose", "[", "distBlock", "]"}]}], ";"}]}], "\n", 
            "\t\t", "]"}], ";"}], "\n", "\t ", ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "1", ",", " ", "numBlocks"}], "}"}], ",", 
          " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", "i", ",", " ", "numBlocks"}], "}"}]}], 
         "]"}], ";", "\n", "\n", "\t", 
        RowBox[{"SetDirectory", "[", "outputDir", "]"}], ";", "\n", "\t", 
        RowBox[{"Put", "[", 
         RowBox[{
          RowBox[{"Compress", "[", "dists", "]"}], ",", " ", 
          RowBox[{"distName", " ", "<>", " ", "\"\<.dat\>\""}]}], "]"}], ";", 
        "\n", "\n", "\t", 
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"\"\<Finished \>\"", " ", "<>", " ", "distName"}], "]"}], 
        ";"}], "\n", ")"}], "&"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<dist-descr\>\"", ",", " ", "\"\<dist-euclid\>\"", ",", " ", 
       "\"\<dist-info\>\"", ",", " ", "\"\<dist-manhat\>\"", ",", " ", 
       "\"\<dist-ssim\>\""}], "}"}]}], "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<Done.\>\"", "]"}], ";"}]}], "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->False,
 CellChangeTimes->{{3.5900258292727613`*^9, 3.590025864876798*^9}, 
   3.5900270183007703`*^9, {3.5900282764957347`*^9, 3.590028322430362*^9}, {
   3.5902414858210135`*^9, 3.590241510947013*^9}, {3.5915782938750124`*^9, 
   3.591578301956475*^9}, {3.593632486758211*^9, 3.593632535863612*^9}, {
   3.5936362092073956`*^9, 3.593636216121724*^9}, {3.5937837702846704`*^9, 
   3.5937838003746705`*^9}, {3.5937838500396705`*^9, 
   3.5937838683446703`*^9}, {3.5937839044436703`*^9, 
   3.5937839108856707`*^9}, {3.5937841113706703`*^9, 
   3.5937841233196707`*^9}, {3.605472529764188*^9, 3.6054725375595875`*^9}, {
   3.607305745289697*^9, 3.6073057473508153`*^9}, {3.6073059120572357`*^9, 
   3.607305922876855*^9}, 3.6073059841483593`*^9, {3.607306098763915*^9, 
   3.6073062552208633`*^9}, {3.6073063421708364`*^9, 
   3.6073063454430237`*^9}, {3.607554758800976*^9, 3.607554795257061*^9}, 
   3.607559631009574*^9, 3.6076108013185053`*^9, 3.6076134268115053`*^9, 
   3.6076161126625056`*^9, {3.6076186921545057`*^9, 3.6076186926745057`*^9}, {
   3.607621908192966*^9, 3.607621908643056*^9}, 3.6076238187172375`*^9, 
   3.6076312548837795`*^9, {3.6081438905927176`*^9, 3.6081439020163713`*^9}, {
   3.6081502610180855`*^9, 3.6081502614941125`*^9}, {3.60815595108407*^9, 
   3.608155953979689*^9}, 3.6081583171398177`*^9, {3.6082972295548964`*^9, 
   3.6082972392759542`*^9}, {3.609116359475876*^9, 3.6091164448417587`*^9}, {
   3.6091165263434205`*^9, 3.609116661959177*^9}, 3.6091166945440407`*^9, {
   3.609116844870639*^9, 3.609116851483017*^9}, {3.6091177329544344`*^9, 
   3.6091177348535433`*^9}, 3.6091178103788633`*^9, 3.609122850706523*^9, {
   3.6091238246522694`*^9, 3.60912383435527*^9}, {3.609125958080989*^9, 
   3.609126033575014*^9}, {3.6091260834538713`*^9, 3.6091261406763525`*^9}, 
   3.6091715992773485`*^9, 3.6091871571201878`*^9, {3.609196447795721*^9, 
   3.609196465595746*^9}, {3.609196867745411*^9, 3.6091968692493362`*^9}, {
   3.6092013301985865`*^9, 3.609201336658596*^9}, {3.6094335199723835`*^9, 
   3.609433597580839*^9}, {3.611689256163521*^9, 3.611689290229491*^9}, {
   3.611689343135064*^9, 3.611689372447189*^9}, {3.6116895266236343`*^9, 
   3.6116895341075306`*^9}, {3.6117746141002703`*^9, 3.611774730464113*^9}, {
   3.611791893632397*^9, 3.611791902868103*^9}, {3.6118035988530097`*^9, 
   3.611803677256225*^9}, {3.611806530794865*^9, 3.611806570438966*^9}, {
   3.611839938737218*^9, 3.6118399585787215`*^9}, {3.611853480294531*^9, 
   3.611853500203499*^9}, {3.611855294554266*^9, 3.6118552947447033`*^9}, {
   3.6119435065855017`*^9, 3.6119435779986424`*^9}, {3.611943628807723*^9, 
   3.6119436407449164`*^9}, {3.6119443165314884`*^9, 
   3.6119444490987434`*^9}, {3.611945085198349*^9, 3.6119450973775663`*^9}, {
   3.6119661464339542`*^9, 3.611966245276439*^9}, 3.611966414858908*^9, {
   3.611969417250207*^9, 3.6119694346714134`*^9}, {3.611969565254303*^9, 
   3.611969571467635*^9}, {3.6127100776920705`*^9, 3.612710088770463*^9}, {
   3.6138153681202445`*^9, 3.613815386663925*^9}, {3.6140158001708803`*^9, 
   3.6140158095335445`*^9}, {3.615530484380446*^9, 3.615530494170446*^9}, {
   3.6237744253375897`*^9, 3.6237744331181397`*^9}, {3.6237748486970053`*^9, 
   3.623774848837199*^9}, {3.62377508050051*^9, 3.6237751059472227`*^9}, {
   3.6237752411591787`*^9, 3.6237752473143845`*^9}, {3.624159472456005*^9, 
   3.6241594924009275`*^9}, 3.6256039003264575`*^9, {3.6256150436615276`*^9, 
   3.62561510773934*^9}, {3.625615143058735*^9, 3.625615168957562*^9}, {
   3.6256152636082916`*^9, 3.6256153257078605`*^9}, {3.62561540401682*^9, 
   3.625615532226846*^9}, {3.6256156358579335`*^9, 3.6256156436410484`*^9}, {
   3.62561572754963*^9, 3.6256158548876963`*^9}, {3.6256189664294167`*^9, 
   3.625618968820465*^9}, {3.625619272132119*^9, 3.625619286831154*^9}, {
   3.625619636200493*^9, 3.625619669987542*^9}, {3.625619743131459*^9, 
   3.6256197469764147`*^9}, {3.6256198077357855`*^9, 
   3.6256198168785706`*^9}, {3.625619879063693*^9, 3.6256199224491253`*^9}, 
   3.6256200350542808`*^9, {3.6256222336939516`*^9, 3.6256223880749235`*^9}, {
   3.6256246995815153`*^9, 3.6256247130533996`*^9}, {3.625624807907028*^9, 
   3.6256248438332653`*^9}, {3.6256248912363667`*^9, 
   3.6256249411703367`*^9}, {3.6256251976080885`*^9, 3.625625199952308*^9}, {
   3.6256252905542665`*^9, 3.62562530671898*^9}, {3.625626937526267*^9, 
   3.6256269426051025`*^9}, {3.6257072632098646`*^9, 3.625707269898923*^9}, {
   3.625707591388418*^9, 3.6257075968583107`*^9}, {3.625707978898925*^9, 
   3.625707984431001*^9}, {3.625708242233004*^9, 3.625708250686993*^9}, {
   3.625709393351859*^9, 3.6257093996507816`*^9}, {3.625709561931332*^9, 
   3.6257095682133627`*^9}, {3.6257099509132943`*^9, 
   3.6257099580244484`*^9}, {3.6257105222084746`*^9, 3.625710527915139*^9}, {
   3.6257146535958815`*^9, 3.625714658987034*^9}, {3.6257148417704887`*^9, 
   3.6257148526796026`*^9}, {3.6257151514278007`*^9, 
   3.6257151576945596`*^9}, {3.6257156145491133`*^9, 
   3.6257156187370424`*^9}, {3.625717691109748*^9, 3.6257176964852057`*^9}, {
   3.6257536542038527`*^9, 3.6257536694560475`*^9}, {3.6257541677542257`*^9, 
   3.6257541864551697`*^9}, {3.625754496101023*^9, 3.6257545085871973`*^9}, {
   3.625755541515172*^9, 3.6257555513337364`*^9}, {3.6257560264778347`*^9, 
   3.625756036573777*^9}, {3.6257572361941605`*^9, 3.6257572399298296`*^9}, {
   3.6257576752251916`*^9, 3.6257576795070915`*^9}, {3.625758573047239*^9, 
   3.6257585810643296`*^9}, {3.6257587388200054`*^9, 3.62575874384241*^9}, {
   3.6257597122447376`*^9, 3.625759717182723*^9}, {3.6257599005788116`*^9, 
   3.6257599055951405`*^9}, {3.625760760895819*^9, 3.6257607660373983`*^9}, {
   3.6257608550899057`*^9, 3.625760859356406*^9}, {3.625784814736318*^9, 
   3.6257848199713683`*^9}, {3.6257857927065363`*^9, 3.625785796691456*^9}, {
   3.6257859713745346`*^9, 3.6257859800819893`*^9}, {3.625786359040544*^9, 
   3.625786364588752*^9}, {3.630791439528532*^9, 3.6307915064400997`*^9}, {
   3.630791549794099*^9, 3.6307915695502396`*^9}, {3.630791656964875*^9, 
   3.6307916598402195`*^9}, {3.63079175342338*^9, 3.6307917698756666`*^9}, {
   3.6307918001587577`*^9, 3.630791812891599*^9}, {3.630792313216737*^9, 
   3.630792345194787*^9}, {3.6307923961767874`*^9, 3.630792398958863*^9}, {
   3.630793142662013*^9, 3.6307932258692093`*^9}, {3.630793269765858*^9, 
   3.630793279536368*^9}, {3.6307934567439685`*^9, 3.630793708877591*^9}, {
   3.630794878303548*^9, 3.630795051922011*^9}, {3.630795573263891*^9, 
   3.6307955768399343`*^9}, {3.6307956537470474`*^9, 
   3.6307956859232693`*^9}, {3.6307957270286837`*^9, 
   3.6307957356503825`*^9}, {3.6307957891456623`*^9, 
   3.6307957995574894`*^9}, {3.630795855691593*^9, 3.630795896896716*^9}, {
   3.630796060853955*^9, 3.6307961090662966`*^9}, {3.6307961720070515`*^9, 
   3.6307961987549286`*^9}, {3.6307962768304157`*^9, 3.630796458254304*^9}, {
   3.63079651575645*^9, 3.6307965192743144`*^9}, {3.63079670045982*^9, 
   3.6307967039011564`*^9}, {3.6307967957669983`*^9, 
   3.6307967959701166`*^9}, {3.6307969025165005`*^9, 3.630796912456335*^9}, {
   3.6307969553059874`*^9, 3.6307969573219023`*^9}, {3.6307973114396653`*^9, 
   3.6307973217555003`*^9}, {3.6307974365350733`*^9, 3.630797439478796*^9}, {
   3.6307977096222415`*^9, 3.63079771461226*^9}, {3.6307978162661085`*^9, 
   3.6307978219403553`*^9}, {3.6307979289188037`*^9, 3.630797929121971*^9}, {
   3.630798093034446*^9, 3.6307980958784204`*^9}, {3.6308880481858697`*^9, 
   3.630888296698237*^9}, {3.630888370913756*^9, 3.630888418439316*^9}, {
   3.630888454681615*^9, 3.6308884849460993`*^9}, {3.6308885417581053`*^9, 
   3.630888551434023*^9}, {3.6308898281547375`*^9, 3.630889842870592*^9}, {
   3.6308918258153877`*^9, 3.6308918405382605`*^9}, {3.630892282637442*^9, 
   3.6308923035377216`*^9}, {3.6308925031718016`*^9, 
   3.6308925041874185`*^9}, {3.630893123967134*^9, 3.6308931578292766`*^9}, {
   3.6308932313511705`*^9, 3.630893315424046*^9}, {3.63093322316965*^9, 
   3.630933223217653*^9}, {3.6322668581899834`*^9, 3.632266922456623*^9}, {
   3.6322670239848356`*^9, 3.6322670535458612`*^9}, {3.632267200826503*^9, 
   3.632267225192339*^9}, {3.632267457649988*^9, 3.632267458853531*^9}, {
   3.632267603369564*^9, 3.6322676055260954`*^9}, {3.6322680988494043`*^9, 
   3.6322681072992067`*^9}, 3.6322690923694324`*^9, 3.63227518090088*^9, {
   3.633638376388468*^9, 3.6336385917187805`*^9}, 3.6336386711441517`*^9, {
   3.6336388037510424`*^9, 3.63363883010313*^9}, {3.6336522137169294`*^9, 
   3.6336522268298025`*^9}, {3.6337147912846584`*^9, 3.633714799489453*^9}, {
   3.633715917924547*^9, 3.63371608447044*^9}, 3.633716125030511*^9, {
   3.6337165131123924`*^9, 3.6337165430020447`*^9}, {3.6337359984831743`*^9, 
   3.633736021805215*^9}, 3.63382729670813*^9, {3.633827340856208*^9, 
   3.633827360855443*^9}, {3.6338310844504433`*^9, 3.6338311310854993`*^9}, 
   3.633831257560344*^9, {3.6338854745553045`*^9, 3.6338854760061073`*^9}, {
   3.633885725688546*^9, 3.6338859089888678`*^9}, {3.6338860894271855`*^9, 
   3.6338861297376566`*^9}, {3.6338861871317577`*^9, 3.63388618833296*^9}, {
   3.633886280900038*^9, 3.633886384020619*^9}, {3.6338864746892786`*^9, 
   3.633886524343566*^9}, {3.633886570132205*^9, 3.6338867087927485`*^9}, {
   3.633886849586998*^9, 3.6338868726201386`*^9}, {3.633887133795415*^9, 
   3.6338872746008625`*^9}, 3.6338873077821207`*^9, {3.63388734150938*^9, 
   3.6338873457681875`*^9}, {3.633887378707345*^9, 3.633887385961358*^9}, {
   3.6338926767264533`*^9, 3.633892683390665*^9}, {3.6338935097142763`*^9, 
   3.633893540071929*^9}, {3.6399245362106595`*^9, 3.6399245582261004`*^9}, {
   3.63992477396369*^9, 3.639924776553294*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Compute metadata", "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 CellChangeTimes->{{3.590025455126362*^9, 3.5900254906913958`*^9}, {
   3.5900255904221*^9, 3.590025598479561*^9}, {3.590025788141409*^9, 
   3.5900258211132956`*^9}, {3.5900261408725843`*^9, 3.590026149314067*^9}, 
   3.5900263467493596`*^9, 3.590026424154787*^9, {3.590026622947157*^9, 
   3.590026629369525*^9}, {3.5900273411432357`*^9, 3.5900273422032967`*^9}, 
   3.625623542392795*^9, 3.633715586579965*^9, {3.6337165707076936`*^9, 
   3.633716573422098*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "extracts", " ", "the", " ", "taxonomic", " ", 
    "classification", " ", "string", " ", "from", " ", "an", " ", "NCBI", " ",
     "GB", " ", "XML", " ", "document"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GetTaxonomy", "[", "x_", "]"}], " ", ":=", " ", "\n", "\t", 
     RowBox[{"First", "@", 
      RowBox[{"Cases", "[", 
       RowBox[{"x", ",", " ", 
        RowBox[{
         RowBox[{"XMLElement", "[", 
          RowBox[{"\"\<GBSet\>\"", ",", "_", ",", " ", 
           RowBox[{"{", 
            RowBox[{"XMLElement", "[", 
             RowBox[{"\"\<GBSeq\>\"", ",", "_", ",", " ", 
              RowBox[{"{", 
               RowBox[{"___", ",", 
                RowBox[{"XMLElement", "[", 
                 RowBox[{"\"\<GBSeq_taxonomy\>\"", ",", 
                  RowBox[{"{", "}"}], ",", " ", 
                  RowBox[{"{", "taxonomy_", "}"}]}], "]"}], ",", "___"}], 
               "}"}]}], "]"}], "}"}]}], "]"}], " ", "\[RuleDelayed]", " ", 
         "taxonomy"}], ",", " ", "Infinity"}], "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "the", " ", "URL", " ", "from", " ", "where", " ", "to", " ", "get", " ", 
     "the", " ", "XML"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
    "NCBIurl", " ", "=", " ", 
     "\"\<http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=\
nucleotide&rettype=gb&retmode=xml&id=\>\""}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "fastaDir", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ParallelEvaluate", "[", 
     RowBox[{"SetDirectory", "[", "fastaDir", "]"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Monitor", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"i", " ", "=", " ", "0"}], ";", " ", 
       RowBox[{"SetSharedVariable", "[", "i", "]"}], ";", "\n", "\t", 
       RowBox[{"files", " ", "=", " ", 
        RowBox[{"FileNames", "[", "\"\<*.fasta\>\"", "]"}]}], ";", "\n", "\n",
        "\t", 
       RowBox[{"metadata", " ", "=", " ", 
        RowBox[{"ParallelMap", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"i", "++"}], ";", " ", "\n", "\t\t", 
             RowBox[{"importData", " ", "=", " ", 
              RowBox[{"Flatten", "@", 
               RowBox[{"Import", "[", 
                RowBox[{"#", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Description\>\"", ",", " ", "\"\<Accession\>\"", ",", 
                    " ", "\"\<GenBankID\>\"", ",", " ", "\"\<Length\>\""}], 
                   "}"}], "}"}]}], "]"}]}]}], ";", "\n", "\t\t", 
             RowBox[{"taxonomy", " ", "=", " ", 
              RowBox[{"GetTaxonomy", "@", 
               RowBox[{"Import", "[", 
                RowBox[{
                 RowBox[{"NCBIurl", " ", "<>", " ", 
                  RowBox[{"importData", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
                 "\"\<XML\>\""}], "]"}]}]}], ";", "\n", "\n", "\t\t", 
             RowBox[{"Append", "[", 
              RowBox[{"importData", ",", " ", "taxonomy"}], "]"}]}], "\n", 
            "\t", ")"}], "&"}], ",", " ", "files"}], "]"}]}], ";"}], "\n", 
      ",", " ", "\n", "\t", 
      RowBox[{"TableForm", "[", 
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"\"\<Computing metadata element \>\"", " ", "<>", " ", 
          RowBox[{"ToString", "[", "i", "]"}], " ", "<>", " ", "\"\</\>\"", 
          " ", "<>", " ", 
          RowBox[{"ToString", "[", 
           RowBox[{"Length", "[", "files", "]"}], "]"}]}], ",", " ", "\n", 
         "\t\t", 
         RowBox[{"ProgressIndicator", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "i", "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", 
             RowBox[{"Length", "[", "files", "]"}]}], "}"}]}], "]"}]}], "\n", 
        "\t", "}"}], "]"}]}], "\n", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "outputDir", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Put", "[", 
     RowBox[{
      RowBox[{"Compress", "[", "metadata", "]"}], ",", " ", 
      "\"\<metadata.dat\>\""}], "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<Done.\>\"", "]"}], ";"}]}]}]], "Code",
 CellOpen->True,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->False,
 CellChangeTimes->{{3.5894966897375665`*^9, 3.589496712237454*^9}, {
   3.5894968394913635`*^9, 3.5894969273082123`*^9}, {3.5895106194257665`*^9, 
   3.5895106273557587`*^9}, {3.5898472507474937`*^9, 3.589847266512396*^9}, {
   3.589850566406555*^9, 3.5898505715913243`*^9}, 3.589851116944766*^9, {
   3.589851154404766*^9, 3.589851155459766*^9}, {3.589934623179574*^9, 
   3.589934649840099*^9}, {3.5899356338983836`*^9, 3.5899357852490406`*^9}, {
   3.589935816448825*^9, 3.589935874840165*^9}, {3.5899374617649264`*^9, 
   3.589937498136935*^9}, {3.5899381040605917`*^9, 3.5899381137801476`*^9}, {
   3.590027093544074*^9, 3.590027106661824*^9}, {3.5900292939127674`*^9, 
   3.5900292994570847`*^9}, {3.5900321504931173`*^9, 3.590032180991171*^9}, {
   3.590110277059164*^9, 3.590110278884368*^9}, {3.607306862825617*^9, 
   3.607306862999626*^9}, {3.607306957315021*^9, 3.607306981525406*^9}, {
   3.6073072447654624`*^9, 3.6073072480586505`*^9}, {3.6073090966563845`*^9, 
   3.607309097120411*^9}, {3.607309295452755*^9, 3.6073093966755447`*^9}, {
   3.607309437319869*^9, 3.6073094435672264`*^9}, {3.6086583446555758`*^9, 
   3.6086583479424744`*^9}, {3.6086584255546947`*^9, 3.608658433994584*^9}, {
   3.6086758135845613`*^9, 3.6086758152563295`*^9}, {3.6091206100599957`*^9, 
   3.6091206510173383`*^9}, {3.6091207068865337`*^9, 3.609120779599693*^9}, {
   3.6091586719481974`*^9, 3.6091586832249975`*^9}, {3.609990687331872*^9, 
   3.6099906935252266`*^9}, {3.609990740918937*^9, 3.6099908053176203`*^9}, {
   3.6099908559495163`*^9, 3.6099908609288015`*^9}, {3.609990918091071*^9, 
   3.6099909188141117`*^9}, {3.6099909856179333`*^9, 3.609991012861491*^9}, {
   3.610116167397427*^9, 3.610116213318427*^9}, {3.6116903669172506`*^9, 
   3.6116904137178755`*^9}, {3.611690694845858*^9, 3.6116907325064836`*^9}, {
   3.611690819722723*^9, 3.6116908999416237`*^9}, {3.6116909518195925`*^9, 
   3.6116910453035746`*^9}, {3.611691230558876*^9, 3.611691231142763*^9}, {
   3.61169175868524*^9, 3.6116917902222843`*^9}, {3.611691832167842*^9, 
   3.611691857022696*^9}, {3.6117184792096033`*^9, 3.611718480293518*^9}, {
   3.625623542392795*^9, 3.625623682333066*^9}, {3.6256237137236376`*^9, 
   3.625623761287896*^9}, {3.6256238146533284`*^9, 3.625623890919354*^9}, 
   3.630801217432099*^9, {3.6308021784194937`*^9, 3.630802178888955*^9}, {
   3.630802220017494*^9, 3.6308022363381467`*^9}, {3.6308022982241745`*^9, 
   3.6308022999761467`*^9}, {3.630802388928239*^9, 3.630802456782094*^9}, {
   3.630802489612625*^9, 3.63080256100395*^9}, {3.6308025924099207`*^9, 
   3.630802600021211*^9}, {3.630802656669367*^9, 3.6308026886058946`*^9}, {
   3.630802725841109*^9, 3.6308027333289075`*^9}, {3.63086989770205*^9, 
   3.630869904103243*^9}, {3.6308699816660776`*^9, 3.6308700193075686`*^9}, {
   3.6308925132574005`*^9, 3.6308925136480303`*^9}, {3.6309332280139284`*^9, 
   3.630933228052931*^9}, {3.632262723737444*^9, 3.632262733509125*^9}, 
   3.632269097450074*^9, 3.633715586579965*^9, {3.633716561394477*^9, 
   3.6337165619560785`*^9}, {3.633716985340822*^9, 3.6337170973958187`*^9}, {
   3.633717202352803*^9, 3.633717471390876*^9}, {3.6337175379717927`*^9, 
   3.633717540311797*^9}, {3.6337176778918657`*^9, 3.633717704692713*^9}, {
   3.6337177838940516`*^9, 3.633717794907671*^9}, {3.6337180125234003`*^9, 
   3.6337180485594635`*^9}, {3.63389269179908*^9, 3.6338926984994917`*^9}, {
   3.6399247822961044`*^9, 3.6399247855097103`*^9}}]
}, Closed]]
},
WindowSize->{1280, 942},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
ShowSelection->True,
ShowGroupOpener->True,
FrontEndVersion->"10.1 for Microsoft Windows (32-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 418, 6, 49, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[1000, 30, 9144, 185, 973, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}]
}, Closed]],
Cell[CellGroupData[{
Cell[10181, 220, 523, 7, 41, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[10707, 229, 13954, 231, 673, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->False]
}, Closed]],
Cell[CellGroupData[{
Cell[24698, 465, 564, 8, 41, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10002.}],
Cell[25265, 475, 17018, 292, 1153, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10002.},
 InitializationCell->False]
}, Closed]],
Cell[CellGroupData[{
Cell[42320, 772, 564, 8, 41, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10004.}],
Cell[42887, 782, 14521, 245, 733, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10004.},
 InitializationCell->False]
}, Closed]],
Cell[CellGroupData[{
Cell[57445, 1032, 490, 7, 41, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10003.}],
Cell[57938, 1041, 16197, 280, 813, "Code",
 CellGroupingRules->{GroupTogetherGrouping, 10003.},
 InitializationCell->False]
}, Closed]],
Cell[CellGroupData[{
Cell[74172, 1326, 557, 8, 41, "Subsection",
 CellGroupingRules->{GroupTogetherGrouping, 10001.}],
Cell[74732, 1336, 7964, 154, 633, "Code",
 CellOpen->True,
 CellGroupingRules->{GroupTogetherGrouping, 10001.},
 InitializationCell->False]
}, Closed]]
}
]
*)

(* End of internal cache information *)
